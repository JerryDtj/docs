# 数据持久化AOF和RDB
主要是分成2种 AOF 和 RDB
## AOF以及AOF重写
1. 通过aof_buf缓冲区对指定时间内所有的操作进行记录
2. 通过aof_rewrite_buf缓冲区对指令进行优化重写
3. 把优化后的指令加入aof_buf缓冲区。防止指令遗漏
4. 修改原来的aof文件，把优化后的指令写入
## RDB
按照在指定时间内，达到指定请求时，触发的数据全量备份
## AOF+RDB
两种机制全部开启的时候，Redis在重启的时候会默认使用AOF去重新构建数据，因为AOF的数据是比RDB更完整的。